### Tags: `Hydra` `SMB` `ssh2john` `scp`

# Escaneo (*22,80,139,445,8009,8080*)
```css
  sudo nmap -p- --open -sSCV --min-rate 4000 -vvv -n -Pn 10.10.213.17 -oN escaneo
```
![image](https://github.com/user-attachments/assets/211853b8-896b-4f56-a115-479bd9f4773e)

# SMB client (**445**)
Con `-L` para poder ver que había dentro del SMB

![image](https://github.com/user-attachments/assets/e7c17852-8ac9-4205-b4c1-60de0f61b443)

Así es como se pondria para poder ver lo que hay dentro de Anonymous --> `-N` para ver si se puede entrar sin proporcionar contraseña
Nos traemos el .txt con el parámetro `get` 
![image](https://github.com/user-attachments/assets/2772ebf3-600b-46c3-8382-766021f4ccb0)

Ahora vemos que que en nuestra máquina se nos descargó el archivo `staff.txt` extraído del SMB de la "víctima"
Y claramente podes ver que Tenemos un nombre de usuario llamado ``Jan``

![image](https://github.com/user-attachments/assets/c3e4e3fc-f117-4a2e-b408-17e270a1a9df)

## Hydra (**ssh**)
Como tenemos un posible usuario "Jan" y tenemos el puerto 22 OPEN-shh, podes hacer fuerza bruta para decifrar la contraseña

![image](https://github.com/user-attachments/assets/d41f1b49-f959-40ba-87aa-39f534207eca)


Nos conectamos por ssh e introducimos la contraseña
![image](https://github.com/user-attachments/assets/02048337-3460-4112-a030-23feb85e70ff)

# Escalada (kay)
Navegando un poco veremos que hay un usuario Kay en cual se filtra su id_rsa ---> El cual sabiendo eso nos lo extraemos a nuestra máquina con el comando `SCP`

![image](https://github.com/user-attachments/assets/0f99d92a-8770-4c68-b7bb-ddd26e34fc63)
![image](https://github.com/user-attachments/assets/a62422fe-acf2-4d2a-b27d-f377246f2053)

Con *ssh2john* le pasamos la `id_rsa` que nos trajimos antes y que lo guarde en un archivito llamado `password.txt`
![image](https://github.com/user-attachments/assets/575ed533-805d-4736-bd02-f210a93af285)

Ahora lo que hacemos es jugar con John The Ripper para decifrar su pass

![image](https://github.com/user-attachments/assets/9d409478-fcf8-40b6-9bfe-a6a36544f8c1)


Fundamental poner **chmod 600 id_rsa** ---> sino NO funciona
Entonces nos conectamos vía ssh con el usuario Kay, la ip y el parámetro ``-i`` porque nos conectamos con su id_rsa

![image](https://github.com/user-attachments/assets/9f958cd7-39d1-4a17-a680-52a295a530a9)

## Escalada ROOT
Haciendo `sudo -l` podemos ejecutar como root */usr/bin/html2text* y para escalar tenemos que hacer lo siguienet:

![image](https://github.com/user-attachments/assets/67cbae3d-004b-4c3b-9ce4-10ce39bf8217)
![image](https://github.com/user-attachments/assets/112589e2-f800-466c-b33e-4b39f376c188)


